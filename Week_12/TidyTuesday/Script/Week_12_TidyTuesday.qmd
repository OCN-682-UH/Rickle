---
title: "Week 12: Tidy Tuesday 2"
author: "SZR"
format: 
  html:
    toc: true
    toc-location: right
    toc-title: "Contents"
    code-fold: true
---


# Load Libraries
```{r}
#| message: false

library(tidyverse)
library(dplyr)
library(here)
library(plotly)
```


# Data and cleaning

This Tidy Tuesday data shows global incidences of Tuberculosis, mortality, mortality associated with HIV, and population. The most recent data (2023) was selected for analysis. 
```{r}
#| message: false

tuesdata <- tidytuesdayR::tt_load(2025, week = 45)
who_tb_data <- tuesdata$who_tb_data

tb_2023 <- who_tb_data %>%
  filter(year == 2023)
```


# Plotting
```{r}
tb_plot2023 <- ggplot(tb_2023, aes( ## plotting new incidences/100k rate versus mortality/100k rate
  x = c_newinc_100k,
  y = e_mort_100k,
  size = e_pop_num, ## size of bubbles corresponding to population number
  color = g_whoregion, ## displaying regions by color
  text = paste0( ## setting the interactive text information to display the following
    "Country: ", country, "<br>",
    "Region: ", g_whoregion, "<br>",
    "Incidence: ", round(c_newinc_100k, 1), " per 100k<br>",
    "Mortality: ", round(e_mort_100k, 1), " per 100k<br>",
    "Population: ", format(e_pop_num, big.mark = ",")
  ))) +
  geom_point(alpha = 0.6) +
  scale_size(range = c(2, 20), name = "Population") + ## creating specific point size
  labs( ## changing axis labels and title
    title = "TB Incidence vs Mortality by Region in 2023",
    x = "Incidence per 100k",
    y = "Mortality per 100k",
    color = "Region"
  ) +
  theme_minimal()

tb_interactive <- ggplotly(tb_plot2023, tooltip = "text") ## making it interactive

htmlwidgets::saveWidget(
  widget = tb_interactive,
  file = here("Week_12", "TidyTuesday", "Output", "tb_interactive.html")
)
```

This bubble diagram shows Tuberculosis incidences versus mortality with bubbles representing countries, colors corresponding to broader regions, and point size showing population size. Specific information is shown when hovering over each point. 

I used the **plotly** package again, but this time to create an **interactive bubble diagram** that displays many pieces of information. 

