---
title: "Week 11: Tidy Tuesday 1"
author: "SZR"
format: 
  gfm:   # to save as a file that can be viewed in GitHub
    toc: true
    toc-location: right
    toc-title: "Contents"
    code-fold: true
prefer-html: true
---

# Load Libraries
```{r}
#| message: false

library(tidyverse)
library(dplyr)
library(plotly)
library(here)
```


# Load Data & Cleaning

This week's Tidy Tuesday provides 2015 records of lead levels within water from Flint Michigan according to the Michigan Department of Environment (MDEQ) and Virginia Tech (VT). 
```{r}
#| message: false

tuesdata <- tidytuesdayR::tt_load(2025, week = 44)

flint_mdeq <- tuesdata$flint_mdeq
flint_vt <- tuesdata$flint_vt

combined <- flint_mdeq %>%
  select(sample, lead_mdeq = lead) %>%
  left_join(flint_vt, by = "sample") %>%
  rename(lead_vt = lead) %>%
  arrange(sample)
```


# Plotting
```{r}
#| message: false

mdeq_color <- "#D55E00" ## creating an orange color vector for mdeq data
vt_color   <- "#0072B2" ## creating a blue color vector for vt data

flint_lead_levels <- plot_ly(combined) %>%
  add_trace( ## first working with mdeq data
    x = ~sample, 
    y = ~lead_mdeq,
    type = "scatter", mode = "lines+markers", ## setting point type and adding lines & markers
    name = "MDEQ", ## naming the line
    line = list(color = mdeq_color, width = 2), ## using the color vector for the line and adjusting width
    marker = list(color = mdeq_color, size = 6), ## making smaller point size with same color vector
    hoverinfo = "text", ## adding hover info
    text = ~paste0( ## setting the text info
      "<b>Sample:</b> ", sample,
      "<br><b>MDEQ Lead:</b> ", lead_mdeq, " ppb"
    )) %>%
  add_trace( ## now working with vt data, same process as above
    x = ~sample, 
    y = ~lead_vt,
    type = "scatter", mode = "lines+markers",
    name = "VT",
    line = list(color = vt_color, width = 2),
    marker = list(color = vt_color, size = 6),
    hoverinfo = "text",
    text = ~paste0(
      "<b>Sample:</b> ", sample,
      "<br><b>VT Lead:</b> ", lead_vt, " ppb"
    )) %>%
  layout(
    title = "Lead Levels by Sample (Interactive Comparison: MDEQ vs VT)",
    xaxis = list(title = "Sample ID"),
    yaxis = list(title = "Lead (ppb)"),
    hoverlabel = list(bgcolor = "white", font = list(size = 14)))

htmlwidgets::saveWidget(
  widget = flint_lead_levels,
  file = here("Week_11", "TidyTuesday", "Output", "flint_water.html")
)

flint_lead_levels ## so we can see it here too :D

```
This plot shows the drastic differences in lead measurements reported by MDEQ vs VT. 

The **NEW SKILL** I learned during this Tidy Tuesday was creating an **interactive plot using the *plotly* package**. 

